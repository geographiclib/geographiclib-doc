// -*- text -*-
/**
 * \file Geographic.doc
 * \brief Documentation for GeographicLib
 *
 * Written by Charles Karney <charles@karney.com> and licensed under the
 * LGPL.  For more information, see http://geographiclib.sourceforge.net/
 **********************************************************************/
// $Id$
/**
\mainpage Geographic library
\author <a href="http://charles.karney.info/">Charles Karney</a>
<charles@karney.com>
\version 1.7
\date 2010-12-21

\section abstract Abstract

%GeographicLib is a small set of <a href="annotated.html">C++
classes</a> for performing conversions between geographic, UTM, UPS,
MGRS, geocentric, and local cartesian coordinates, for geoid height
calculations, and for solving geodesic problems.  The emphasis is on
returning accurate results with errors close to round-off (about
5&ndash;15 nm).  In addflummoxition, various properties of the \ref
transversemercator are described and an accurate algorithm for \ref
geodesic is given.

This library is <i>not</i> a general purpose projection library; use
<a href="http://trac.osgeo.org/proj/">proj.4</a> for that.  On the other
hand, it does provide the core functionality offered by
<a href="http://earth-info.nima.mil/GandG/geotrans/">geotrans</a> and it
cures several of the defects of that package.

\section download Download

The main project page is at
- <a href="http://sf.net/projects/geographiclib">
  http://sf.net/projects/geographiclib </a>
.
The code is available for download at
- <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.7.tar.gz/download">
  geographiclib-1.7.tar.gz</a>
- <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.7.zip/download">
  geographiclib-1.7.zip</a>
.
as either a compressed tar file (tar.gz) or a zip file.  (The two archives
have identical contents.)

It is licensed under the
<a href="http://www.gnu.org/licenses/lgpl-3.0-standalone.html">LGPL</a>.
For more information, see http://geographiclib.sourceforge.net/

\section contents Contents
 - \ref intro
 - \ref start
 - \ref organization
 - \ref transversemercator
   - \ref testmerc
   - \ref tmseries
 - \ref geodesic
   - \ref testgeod
   - \ref geodseries
 - \ref geocentric
 - \ref geoid
   - \ref geoidinst
   - \ref geoidformat
   - \ref geoidinterp
   - \ref geoidcache
   - \ref testgeoid
 - \ref utilities
 - \ref old

<center>
Forward to \ref intro.
</center>

**********************************************************************/
/**
\page intro Introduction

<center>
Forward to \ref organization.  Up to \ref contents.
</center>

%GeographicLib offers a C++ interfaces to a small (but important!) set
of geographic transformations.  It grew out of a desire to improve on
the <a href="http://earth-info.nima.mil/GandG/geotrans/">geotrans</a>
package for transforming between geographic and MGRS coordinates.  At
present, %GeographicLib provides UTM, UPS, MGRS, geocentric, and local
cartesian projections, geoid heights, and classes for geodesic
calculations.

The goals of %GeographicLib are:
 - Accuracy.  In most applications the accuracy is close to round-off,
   about 5 nm.  Even though in many geographic applications 1 cm is
   considered "accurate enough", there is little penalty in providing
   much better accuracy.  If situations where a faster approximate
   algorithm is necessary, %GeographicLib offers an accurate benchmark to
   guide the development.
 - Completeness.  For each of the projections included, an attempt is
   made to provide a complete solution.  For example,
   GeographicLib::Geodesic::Inverse works for anti-podal points.
   Similarly, GeographicLib::Geocentric.Reverse will return accurate
   geodetic coordinates even for points close to the center of the
   earth.
 - C++ interface.  For the projection methods, this allows encapsulation
   of the ellipsoid parameters.
 - Emphasis on projections necessary for analysing military data.
 - Uniform treatment of UTM/UPS.  The GeographicLib::UTMUPS class treats
   UPS as zone 0.  This simplifies conversions between UTM and UPS
   coordinates, etc.
 - Well defined and stable conventions for the conversion between
   UTM/UPS to MGRS coordinates.
 - Detailed internal documentation on the algorithms.  For the most part
   %GeographicLib uses published algorithms and references are given.  If
   changes have been made (usually to improve the numerical accuracy),
   these are described in the code.

Various \ref utilities are provided with the library.  These illustrate
the use of the library and are useful in their own right.  This library
and the utilities have been tested with g++ 4.4 under Linux, with g++
4.2 under Mac OS X, and with MS Visual Studio 2008.

The section \ref transversemercator documents various properties of this
projection.

The section \ref geodesic documents (still rather incompletely) the
method of solving the geodesic problem.

Undoubtedly, bugs lurk in this code and in the documentation.  Please
report any you find to <charles@karney.com>.

<center>
Forward to \ref start.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page start Getting Started

<center>
Back to \ref intro.  Forward to \ref organization.  Up to \ref contents.
</center>

The following steps will get you started with %GeographicLib:
 - Download the
   <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.7.tar.gz/download">
   source</a>.
 - Unpack the tar file somewhere convenient with, e.g.,
   - tar xfpvz geographiclib-1.7.tar.gz
   .
   This will create a geographiclib-1.7 directory.  (Alternatively,
   download and unpack the zip file.)
 - Change to the geographiclib-1.7 directory
   - cd geographiclib-1.7
 - Create the library and the utility programs
   - make all
   .
   The compiled utility programs are in the tools directory.
 - windows/GeographicLib-vc9.sln (resp. vc8) is MS Visual Studio 2008
   (resp. 2005) solution file which compiles the library and the utility
   programs under Windows.  (Visual Studio 2010 is also supported with a
   vc10 suffix.)
 - Try out <a href="GeoConvert.1.html">GeoConvert</a> (for help, type cd
   tools; ./GeoConvert --help)
   - echo 33.3 44.4 | ./GeoConvert -m -p -3
   - echo 38SMB4484 | ./GeoConvert -d
 - Similarly, try out <a href="Geod.1.html">Geod</a>,
   <a href="Planimeter.1.html">Planimeter</a>,
   <a href="TransverseMercatorTest.1.html">TransverseMercatorTest</a>,
   <a href="CartConvert.1.html">CartConvert</a>, and
   <a href="EquidistantTest.1.html">EquidistantTest</a>.
   <a href="GeoidEval.1.html">GeoidEval</a> requires the installation
   of geoid data, see \ref geoidinst.
 - Read the section, \ref organization, for an overview of the library.
 - Browse the <a href="annotated.html">Class List</a> for full documentation
   on the library.
 - Read the section, \ref transversemercator, for more information on
   this projection.
 - If you use the library frequently, install it, e.g., to \$(PREFIX) =
   /usr/local with
   - make PREFIX=/usr/local install install-doc
 - There is an interface for some %GeographicLib classes to Matlab and
   Octave.  The geographiclibinterface function in the matlab
   directory compiles the interface routines.

Here's a list of some of the abbreviations used here with links to the
corresponding Wikipedia articles:
 - <a href="http://en.wikipedia.org/wiki/WGS84">
   WGS84</a>, World Geodetic System 1984.
 - <a href="http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system">
   UTM</a>, Universal Transverse Mercator coordinate system.
 - <a href="http://en.wikipedia.org/wiki/Universal_Polar_Stereographic">
   UPS</a>, Universal Polar Stereographic coordinate system.
 - <a href="http://en.wikipedia.org/wiki/Military_grid_reference_system">
   MGRS</a>, Military Grid Reference System.
 - <a href="http://en.wikipedia.org/wiki/Geoid">
   EGM</a>, Earth Gravity Model.

<center>
Back to \ref intro.  Forward to \ref organization.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page organization Code organization

<center>
Back to \ref start.  Forward to \ref transversemercator.  Up to \ref contents.
</center>

Here is a brief description of the relationship between the various
components of %GeographicLib.

GeographicLib::TransverseMercator, GeographicLib::PolarStereographic,
GeographicLib::LambertConformalConic, and GeographicLib::AlbersEqualArea
provide the basic projections.  The constructors for these classes
specify the ellipsoid and the forward and reverse projections are
implemented as const member functions.  TransverseMercator uses
Kr&uuml;ger's series which have been extended to sixth order in the
square of the eccentricity.  PolarStereographic, LambertConformalConic,
and AlbersEqualArea use the exact formulas for the projections (from
Snyder).

GeographicLib::TransverseMercator::UTM and
GeographicLib::PolarStereographic::UPS are const static instantiations
specific for the WGS84 ellipsoid with the UTM and UPS scale factors.
(These do \e not add the standard false eastings or false northings for
UTM and UPS.)  Similarly GeographicLib::LambertConformalConic::Mercator
is a const static instantiation of this projection for a WGS84 ellipsoid
and a standard parallel of 0 (which gives the Mercator projection).
GeographicLib::AlbersEqualArea::CylindricalEqualArea,
AzimuthalEqualAreaNorth, and AzimuthalEqualAreaSouth, likewise provide
special cases of the equal area projection.

GeographicLib::UTMUPS uses TransverseMercator::UTM and
PolarStereographic::UPS to perform the UTM and UPS
projections.  The class offers a uniform interface to UTM and UPS by
treating UPS as UTM zone 0.  This class stores no internal state and the
forward and reverse projections are provided via static member
functions.  The forward projection offers the ability to override the
standard UTM/UPS choice and the UTM zone.

GeographicLib::MGRS transforms between UTM/UPS coordinates and MGRS.
UPS coordinates are handled as UTM zone 0.  This class stores no
internal state and the forward (UTM/UPS to MGRS) and reverse (MGRS to
UTM/UPS) conversions are provided via static member functions.

GeographicLib::GeoCoords holds a single geographic location which may be
specified as latitude and longitude, UTM or UPS, or MGRS.  Member
functions are provided to convert between coordinate systems and to
provide formatted representations of them.

<a href="GeoConvert.1.html">GeoConvert</a> is a simple command line
utility to provide access to the GeoCoords class.

GeographicLib::TransverseMercatorExact is a drop in replacement for
TransverseMercator which uses the exact formulas, based on elliptic
functions, for the projection as given by Lee.
<a href="TransverseMercatorTest.1.html">TransverseMercatorTest</a> is a
simple command line utility to test to the TransverseMercator and
TransverseMercatorExact.

GeographicLib::Geodesic and GeographicLib::GeodesicLine perform geodesic
calculations.  The constructor for GeographicLib::Geodesic specifies the
ellipsoid and the direct and inverse calculations are implemented as
const member functions.  GeographicLib::Geocentric::WGS84 is a const
static instantiation of Geodesic specific for the WGS84 ellipsoid.  In
order to perform a series of direct geodesic calculations on a single
line, the GeographicLib::GeodesicLine class can be used.  This packages
all the information needed to specify a geodesic.  A const member
function returns the coordinates a specified distance from the starting
point.  <a href="Geod.1.html">Geod</a> is a simple command line utility
to perform geodesic calculations.  GeographicLib::AzimuthalEquidistant,
GeographicLib::CassiniSoldner, and GeographicLib::Gnomonic are
projections based on the Geodesic class.
<a href="EquidistantTest.1.html">EquidistantTest</a> is a command
line utility to exercise these projections.

GeographicLib::Geocentric and GeographicLib::LocalCartesian convert between
geodetic and geocentric or a local cartesian system.  The constructor for
specifies the ellipsoid and the forward and reverse projections are
implemented as const member functions.  GeographicLib::Geocentric::WGS84 is a
const static instantiation of Geocentric specific for the WGS84 ellipsoid.
<a href="CartConvert.1.html">CartConvert</a> is a simple command line
utility to provide access to these classes.

GeographicLib::Geoid evaluates geoid heights by interpolation.  This is
provided by the operator() member function.
<a href="GeoidEval.1.html">GeoidEval</a> is a simple command line
utility to provide access to this class.  This class requires
installation of data files for the various geoid models; see \ref
geoidinst for details.

GeographicLib::Constants, GeographicLib::Math, GeographicLib::DMS, and
GeographicLib::EllipticFunction are utility classes which are used
internally by the library.  One important definition is
GeographicLib::Math::real_t which is the type used for real numbers.
This allows the library to be easily switched to using floats, doubles,
or long doubles.  However all the testing has been with real_t set to
double and the library should be installed in this way.

In order to avoid name clashes, all there classes are in the
GeographicLib namespace.  The header files are included with the
GeographicLib/ directory prefix.  If compiling within the
%GeographicLib/src or %GeographicLib/tools directories, "../include"
should be included in the header search path (e.g., with -I../include).
The cpp files implementing the classes include "using namespace std;",
however, the headers files and the utility programs do not.

There's an "install" target in the Makefile which installs the library
components into \$(PREFIX)/lib, \$(PREFIX)/include/GeographicLib,
\$(PREFIX)/bin, \$(PREFIX)/share/GeographicLib/doc.  Once installed, the
library can be used by setting
  - INCLUDEPATH = \$(PREFIX)/include
  - LIBPATH = \$(PREFIX)/lib
  .
in tools/Makefile.

The following definitions can be used in your Makefile when using
%GeographicLib, once it has been installed:
  - PREFIX = /usr/local
  - CPPFLAGS = -I\$(PREFIX)/lib
  - LDLIBS = -Wl,"-rpath=$(PREFIX)/lib" -L\$(PREFIX)/lib -lGeographic
  - CC = g++ -g
  - CXXFLAGS = -g -Wall -O3

In general, the constructors for the classes in %GeographicLib check
their arguments and throw GeographicLib::GeographicErr exceptions with a
explanatory message if these are illegal.  The member functions, e.g.,
the projections implemented by TransverseMercator and
PolarStereographic, the solutions to the geodesic problem, etc.,
typically do <i>not</i> check their arguments; the calling program
should ensure that the arguments are legitimate.  However, the functions
implemented by UTMUPS, MGRS, and GeoCoords do check their arguments and
may throw GeographicLib::GeographicErr exceptions.  Similarly Geoid may
throw exceptions on file errors.  If a function does throw an exception,
then the function arguments used for return values will not be altered.

%GeographicLib attempts to act sensibly with NaNs.  NaNs in constructors
typically throw errors (an exception is GeodesicLine).  However, calling
the class functions with NaNs as arguments is not an error; NaNs are
returned as appropriate.  "INV" is treated as an invalid zone
designation by UTMUPS.  "INVALID" is the corresponding invalid MGRS
string.  NaNs allow the projection of polylines which are separated by
NaNs; in this format they can be easily plotted in Matlab.

<center>
Back to \ref start.  Forward to \ref transversemercator.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page transversemercator Transverse Mercator Projection

<center>
Back to \ref organization.  Forward to \ref geodesic.  Up to \ref contents.
</center>

GeographicLib::TransverseMercator and
GeographicLib::TransverseMercatorExact provide accurate implelmentations
of the transverse Mercator projection.  The
 <a href="TransverseMercatorTest.1.html">TransverseMercatorTest</a>
utility provides an interface to these classes.

References
 - L. Kr&uuml;ger, <a
   href="http://dx.doi.org/10.2312/GFZ.b103-krueger28"> Konforme
   Abbildung des Erdellipsoids in der Ebene</a> (Conformal mapping of
   the ellipsoidal earth to the plane), Royal Prussian Geodetic Institute,
   New Series 52, 172 pp. (1912).
 - L. P. Lee,
   Conformal Projections Based on Elliptic Functions,
   (B. V. Gutsell, Toronto, 1976), 128pp.,
   ISBN: 0919870163
   (Also appeared as:
   Monograph 16, Suppl. No. 1 to Canadian Cartographer, Vol 13).
   Part V, pp. 67&ndash;101,
   <a href="http://dx.doi.org/10.3138/X687-1574-4325-WM62">Conformal
   Projections Based On Jacobian Elliptic Functions</a>.
 - C. F. F. Karney,
   <a href="http://dx.doi.org/10.1007/s00190-011-0445-3">
   Transverse Mercator with an accuracy of a few nanometers,</a>
   J. Geodesy (2011);
   preprint
   <a href="http://arxiv.org/abs/1002.1417">arXiv:1002.1417</a>;
   resource page
   <a href="http://geographiclib.sf.net/tm.html">tm.html</a>.
 .
The algorithm for GeographicLib::TransverseMercator is based on
Kr&uuml;ger (1912); that for GeographicLib::TransverseMercatorExact is
based on Lee (1976).

\section testmerc Test data for the transverse Mercator projection

A test set for the transverse Mercator projection is available at
 - <a href="http://sf.net/projects/geographiclib/files/testdata/TMcoords.dat.gz/download">
   TMcoords.dat.gz</a>
 .
This is about 17 MB (compressed).  This test set consists of a set of
geographic coordinates together with the corresponding transverse
Mercator coordinates.  The WGS84 ellipsoid is used, with central
meridian 0<sup>o</sup>, central scale factor 0.9996 (the UTM value),
false easting = false northing = 0 m.

Each line of the test set gives 6 space delimited numbers
 - latitude (degrees, exact)
 - longitude (degrees, exact &mdash; see below)
 - easting (meters, accurate to 0.1 pm)
 - northing (meters, accurate to 0.1 pm)
 - meridian convergence (degrees, accurate to 10<sup>-18</sup> deg)
 - scale (accurate to 10<sup>-20</sup>)
 .
The latitude and longitude are all multiples of 10<sup>-12</sup> deg and
should be regarded as exact, except that longitude =
82.63627282416406551 should be interpreted as exactly 90 (1 - \e e)
degrees.  These results are computed using Lee's formulas with
<a href="http://en.wikipedia.org/wiki/Maxima_(software)">Maxima</a>'s
bfloats and fpprec set to 80 (so the errors in the data are probably 1/2
of the values quoted above).  The Maxima code,
<a href="tm.mac">tm.mac</a> and <a href="ellint.mac">ellint.mac</a>,
used to prepare this data set is included in the distribution.  You will
need to have Maxima installed to use this code.  The comments at the top
of <a href="tm.mac">tm.mac</a> illustrate how to run it.

The contents of the file are as follows:
 - 250000 entries randomly distributed in lat in [0, 90], lon in [0, 90];
 - 1000 entries randomly distributed on lat in [0, 90], lon = 0;
 - 1000 entries randomly distributed on lat = 0, lon in [0, 90];
 - 1000 entries randomly distributed on lat in [0, 90], lon = 90;
 - 1000 entries close to lat = 90 with lon in [0, 90];
 - 1000 entries close to lat = 0, lon = 0 with lat >= 0, lon >= 0;
 - 1000 entries close to lat = 0, lon = 90 with lat >= 0, lon <= 90;
 - 2000 entries close to lat = 0, lon = 90 (1 - \e e) with lat >= 0;
 - 25000 entries randomly distributed in lat
   in [-89, 0], lon in [90 (1 - \e e), 90];
 - 1000 entries randomly distributed on lat in [-89, 0], lon = 90;
 - 1000 entries randomly distributed on lat in [-89, 0], lon = 90 (1 - \e e);
 - 1000 entries close to lat = 0, lon = 90 (lat < 0, lon <= 90);
 - 1000 entries close to lat = 0, lon = 90 (1 - \e e)
   (lat < 0, lon <= 90 (1 - \e e));
 .
(a total of 287000 entries).  The entries for lat < 0<sup>o</sup> and
lon in [90<sup>o</sup> (1 - \e e), 90<sup>o</sup>] use the "extended"
domain for the transverse Mercator projection explained in Sec. 5 of
<a href="http://arxiv.org/abs/1002.1417">arXiv:1002.1417</a>.  The first
258000 entries have lat >= 0<sup>o</sup> and are suitable for testing
implementations following the standard convention.

\section tmseries Series approximation for transverse Mercator

Kr&uuml;ger (1912) gives a 4th-order approximation to the transverse
Mercator projection.  This is accurate to about 200 nm within the UTM
domain.  Here we present the series extended to 10th order.  By default,
GeographicLib::TransverseMercator uses the 6th-order approximation. The
preprocessor variable TM_TX_MAXPOW can be used to select an order from 4
thru 8.  The series expanded to order <i>n</i><sup>30</sup> are given in
<a href="tmseries30.html"> tmseries30.html</a>.

In the formulas below ^ indicates exponentiation (\e n^3 = \e n*\e n*\e
n) and / indicates real division (3/5 = 0.6).  The equations need to be
converted to Horner form, but are here left in expanded form so that
they can be easily truncated to lower order in \e n.  Some of the
integers here are not representable as 32-bit integers and will need to
be included as double literals.

\e A in Kr&uuml;ger, p. 12, eq. (5)
\verbatim
  A = a/(n + 1) * (1 + 1/4 * n^2
                     + 1/64 * n^4
                     + 1/256 * n^6
                     + 25/16384 * n^8
                     + 49/65536 * n^10);
\endverbatim

\e gamma in Kr&uuml;ger, p. 21, eq. (41)
\verbatim
alpha[1] =   1/2 * n
           - 2/3 * n^2
           + 5/16 * n^3
           + 41/180 * n^4
           - 127/288 * n^5
           + 7891/37800 * n^6
           + 72161/387072 * n^7
           - 18975107/50803200 * n^8
           + 60193001/290304000 * n^9
           + 134592031/1026432000 * n^10;
alpha[2] =   13/48 * n^2
           - 3/5 * n^3
           + 557/1440 * n^4
           + 281/630 * n^5
           - 1983433/1935360 * n^6
           + 13769/28800 * n^7
           + 148003883/174182400 * n^8
           - 705286231/465696000 * n^9
           + 1703267974087/3218890752000 * n^10;
alpha[3] =   61/240 * n^3
           - 103/140 * n^4
           + 15061/26880 * n^5
           + 167603/181440 * n^6
           - 67102379/29030400 * n^7
           + 79682431/79833600 * n^8
           + 6304945039/2128896000 * n^9
           - 6601904925257/1307674368000 * n^10;
alpha[4] =   49561/161280 * n^4
           - 179/168 * n^5
           + 6601661/7257600 * n^6
           + 97445/49896 * n^7
           - 40176129013/7664025600 * n^8
           + 138471097/66528000 * n^9
           + 48087451385201/5230697472000 * n^10;
alpha[5] =   34729/80640 * n^5
           - 3418889/1995840 * n^6
           + 14644087/9123840 * n^7
           + 2605413599/622702080 * n^8
           - 31015475399/2583060480 * n^9
           + 5820486440369/1307674368000 * n^10;
alpha[6] =   212378941/319334400 * n^6
           - 30705481/10378368 * n^7
           + 175214326799/58118860800 * n^8
           + 870492877/96096000 * n^9
           - 1328004581729009/47823519744000 * n^10;
alpha[7] =   1522256789/1383782400 * n^7
           - 16759934899/3113510400 * n^8
           + 1315149374443/221405184000 * n^9
           + 71809987837451/3629463552000 * n^10;
alpha[8] =   1424729850961/743921418240 * n^8
           - 256783708069/25204608000 * n^9
           + 2468749292989891/203249958912000 * n^10;
alpha[9] =   21091646195357/6080126976000 * n^9
           - 67196182138355857/3379030566912000 * n^10;
alpha[10]=   77911515623232821/12014330904576000 * n^10;
\endverbatim

\e beta in Kr&uuml;ger, p. 18, eq. (26*)
\verbatim
 beta[1] =   1/2 * n
           - 2/3 * n^2
           + 37/96 * n^3
           - 1/360 * n^4
           - 81/512 * n^5
           + 96199/604800 * n^6
           - 5406467/38707200 * n^7
           + 7944359/67737600 * n^8
           - 7378753979/97542144000 * n^9
           + 25123531261/804722688000 * n^10;
 beta[2] =   1/48 * n^2
           + 1/15 * n^3
           - 437/1440 * n^4
           + 46/105 * n^5
           - 1118711/3870720 * n^6
           + 51841/1209600 * n^7
           + 24749483/348364800 * n^8
           - 115295683/1397088000 * n^9
           + 5487737251099/51502252032000 * n^10;
 beta[3] =   17/480 * n^3
           - 37/840 * n^4
           - 209/4480 * n^5
           + 5569/90720 * n^6
           + 9261899/58060800 * n^7
           - 6457463/17740800 * n^8
           + 2473691167/9289728000 * n^9
           - 852549456029/20922789888000 * n^10;
 beta[4] =   4397/161280 * n^4
           - 11/504 * n^5
           - 830251/7257600 * n^6
           + 466511/2494800 * n^7
           + 324154477/7664025600 * n^8
           - 937932223/3891888000 * n^9
           - 89112264211/5230697472000 * n^10;
 beta[5] =   4583/161280 * n^5
           - 108847/3991680 * n^6
           - 8005831/63866880 * n^7
           + 22894433/124540416 * n^8
           + 112731569449/557941063680 * n^9
           - 5391039814733/10461394944000 * n^10;
 beta[6] =   20648693/638668800 * n^6
           - 16363163/518918400 * n^7
           - 2204645983/12915302400 * n^8
           + 4543317553/18162144000 * n^9
           + 54894890298749/167382319104000 * n^10;
 beta[7] =   219941297/5535129600 * n^7
           - 497323811/12454041600 * n^8
           - 79431132943/332107776000 * n^9
           + 4346429528407/12703122432000 * n^10;
 beta[8] =   191773887257/3719607091200 * n^8
           - 17822319343/336825216000 * n^9
           - 497155444501631/1422749712384000 * n^10;
 beta[9] =   11025641854267/158083301376000 * n^9
           - 492293158444691/6758061133824000 * n^10;
 beta[10]=   7028504530429621/72085985427456000 * n^10;
\endverbatim

The high-order expansions for \e alpha and \e beta were produced by the
Maxima program <a href="tmseries.mac">tmseries.mac</a> (included in the
distribution).  To run, start Maxima and enter
\verbatim
  load("tmseries.mac")$
\endverbatim
Further instructions are included at the top of the file.

<center>
Back to \ref organization.  Forward to \ref geodesic.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page geodesic Geodesics on the Ellipsoid

<center>
Back to \ref transversemercator.  Forward to \ref geocentric.  Up to \ref contents.
</center>

GeographicLib::Geodesic and GeographicLib::GeodesicLine provide accurate
solutions to the direct and inverse geodesic problems.  The
<a href="Geod.1.html">Geod</a> utility provides an interface to these
classes.  GeographicLib::AzimuthalEquidistant implements the azimuthal
equidistant projection in terms of geodesics.
GeographicLib::CassiniSoldner implements a transverse cylindrical
equidistant projection in terms of geodesics.  The
<a href="EquidistantTest.1.html">EquidistantTest</a> utility provides an
interface to these projections.

References
 - F. W. Bessel,
   <a href="http://dx.doi.org/10.1002/asna.201011352">The calculation
   of longitude and latitude from geodesic measurements (1825)</a>,
   Astron. Nachr. 331(8), 852-861 (2010);
   translated by C. F. F. Karney and R. E. Deakin.  Preprint:
   <a href="http://arxiv.org/abs/0908.1824">arXiv:0908.1824</a>.
 - F. R. Helmert,
   <a href="http://geographiclib.sf.net/geodesic-papers/helmert80-en.pdf">
   Mathematical and Physical Theories of Higher Geodesy, Part 1 (1880)</a>,
   Aeronautical Chart and Information Center (St. Louis, 1964),
   Chaps. 5&ndash;7.
 - J. Danielsen,
   The Area under the Geodesic,
   Survey Review 30 (232), 61&ndash;66 (1989).
 - C. F. F. Karney,
   <a href="http://arxiv.org/abs/1102.1215">Geodesics
   on an ellipsoid of revolution</a>,
   Feb. 2011; preprint
   <a href="http://arxiv.org/abs/1102.1215">arxiv:1102.1215</a>
 - A collection of some papers on geodesics is available at
   http://geographiclib.sf.net/geodesic-papers/biblio.html

\section testgeod Test data for geodesics

A test set a geodesics is available at
 - <a href="http://sf.net/projects/geographiclib/files/testdata/GeodTest.dat.gz/download">
   GeodTest.dat.gz</a>
 .
This is about 39 MB (compressed).  This consists of a set of geodesics
for the WGS84 ellipsoid.  A subset of this (consisting of 1/50 of the
members &mdash; about 690 kB, compressed) is available at
 - <a href="http://sf.net/projects/geographiclib/files/testdata/GeodTest-short.dat.gz/download">
   GeodTest-short.dat.gz</a>

Each line of the test set gives 9 space delimited numbers
 - latitude for point 1, \e lat1 (degrees, exact)
 - longitude for point 1, \e lon1 (degrees, always 0)
 - azimuth for point 1, \e azi1 (clockwise from north in degrees, exact)
 - latitude for point 2, \e lat2 (degrees, accurate to 10<sup>-18</sup> deg)
 - longitude for point 2, \e lon2 (degrees, accurate to 10<sup>-18</sup> deg)
 - azimuth for point 2, \e azi2 (degrees, accurate to 10<sup>-18</sup> deg)
 - geodesic distance from point 1 to point 2, \e s12 (meters, exact)
 - arc distance on the auxiliary sphere, \e a12 (degrees, accurate to
   10<sup>-18</sup> deg)
 - reduced length of the geodesic, \e m12 (meters, accurate to 0.1 pm)
 - the area under the geodesic, \e S12 (m<sup>2</sup>, accurate to
   1 mm<sup>2</sup>)
 .
These are computed using as direct geodesic calculations with the given
\e lat1, \e lon1, \e azi1, and \e s12.  The distance \e s12 always
corresponds to an arc length \e a12 <= 180<sup>o</sup>, so the given
geodesics give the shortest paths from point 1 to point 2.  For
simplicity and without loss of generality, \e lat1 is chosen in
[0<sup>o</sup>, 90<sup>o</sup>], \e lon1 is taken to be zero, \e azi1 is
chosen in [0<sup>o</sup>, 180<sup>o</sup>].  Furthermore, \e lat1 and \e
azi1 are taken to be multiples of 10<sup>-12</sup> deg and \e s12 is a
multiple of 0.1 um in [0 m, 20003931.4586254 m].  This results \e lon2
in [0<sup>o</sup>, 180<sup>o</sup>] and \e azi2 in [0<sup>o</sup>,
180<sup>o</sup>].

The direct calculation uses an expansion of the geodesic equations
accurate to \e f<sup>20</sup> (approximately 1 part in 10<sup>50</sup>)
and is computed with with
<a href="http://en.wikipedia.org/wiki/Maxima_(software)">Maxima</a>'s
bfloats and fpprec set to 100 (so the errors in the data are probably
1/2 of the values quoted above).

The contents of the file are as follows:
 - 100000 entries randomly distributed
 - 50000 entries which are nearly antipodal
 - 50000 entries with short distances
 - 50000 entries with one end near a pole
 - 50000 entries with both ends near opposite poles
 - 50000 entries which are nearly meridional
 - 50000 entries which are nearly equatorial
 - 50000 entries running between vertices (\e azi1 = \e azi2 = 90<sup>o</sup>)
 - 50000 entries ending close to vertices
 .
(a total of 500000 entries).  The values for \e s12 for the geodesics
running between vertices are truncated to a multiple of 0.1 pm and this
is used to determine point 2.

This data can be fed to the <a href="Geod.1.html">Geod</a> utility as
follows
 - Direct from point 1:
\verbatim
  gunzip -c GeodTest.dat.gz | cut -d' ' -f1,2,3,7 | ./Geod
\endverbatim
   This should yield columns 4, 5, 6, and 9 of the test set.
 - Direct from point 2:
\verbatim
  gunzip -c GeodTest.dat.gz | cut -d' ' -f4,5,6,7 |
  sed "s/ \([^ ]*$\)/ -\1/" | ./Geod
\endverbatim
   (The sed command negates the distance.)  This should yield columns 1,
   2, and 3, and the negative of column 9 of the test set.
 - Inverse between points 1 and 2:
\verbatim
  gunzip -c GeodTest.dat.gz | cut -d' ' -f1,2,4,5 | ./Geod -i
\endverbatim
   This should yield columns 3, 6, 7, and 9 of the test set.
 .
Add, e.g., "-p 6", to the call to Geod to change the precision of the
output.  Adding "-f" causes Geod to print all 9 fields specifying the
geodesic (in the same order as the test set).

\section geodseries Expansions for geodesics

We give here the series expansions for the various geodesic integrals
valid to order <i>f</i><sup>10</sup>.  In this release of the code, we
use a 6th-order expansions.  This is sufficient to maintain accuracy for
doubles for the SRMmax ellipsoid (\e a = 6400 km, \e f = 1/150).
However, the preprocessor macro GEOD_ORD can be used to select any order
up to 8.  (If using long doubles, with a 64-bit fraction, the default
order is 7.)  The series expanded to order <i>f</i><sup>30</sup> are
given in <a href="geodseries30.html"> geodseries30.html</a>.

In the formulas below ^ indicates exponentiation (\e f^3 = \e f*\e f*\e
f) and / indicates real division (3/5 = 0.6).  The equations need to be
converted to Horner form, but are here left in expanded form so that
they can be easily truncated to lower order.  These expansions were
obtained using the the Maxima code, <a href="geod.mac">geod.mac</a>.

In the expansions below, we have
 - \e alpha is the azimuth
 - \e alpha<sub>0</sub> is the azimuth at the equator crossing
 - \e lambda is the longitude measured from the equator crossing
 - \e omega is the spherical longitude
 - \e sigma is the spherical arc length
 - \e a is the equatorial radius
 - \e b is the polar semi-axis
 - \e f is the flattening
 - \e e<sup>2</sup> = \e f (2 - \e f)
 - \e e'<sup>2</sup> = \e e<sup>2</sup>/(1 - \e e<sup>2</sup>)
 - \e k<sup>2</sup> = \e e'<sup>2</sup> cos<sup>2</sup> \e alpha<sub>0</sub>
   = 4 \e eps / (1 - \e eps)<sup>2</sup>
 - \e n = \e f / (2 - \e f)
 - \e c<sup>2</sup> = \e a<sup>2</sup>/2 + \e b<sup>2</sup>/2 (tanh<sup>-1</sup> \e e)/\e e
 - \e ep2 = \e e'<sup>2</sup>
 - \e k2 = \e k<sup>2</sup>

The formula for distance is

&nbsp; &nbsp; \e s/\e b = \e I1(\e sigma)

where

&nbsp; &nbsp; \e I1(\e sigma) = \e A1 (\e sigma + \e B1(\e sigma))<br>
&nbsp; &nbsp; \e B1(\e sigma) =
sum<sub>\e j = 1</sub> \e C1<sub>j</sub> sin(2 \e j \e sigma)

and

\verbatim
A1 = (1 + 1/4 * eps^2
        + 1/64 * eps^4
        + 1/256 * eps^6
        + 25/16384 * eps^8
        + 49/65536 * eps^10) / (1 - eps);
\endverbatim

\verbatim
C1[1] = - 1/2 * eps
        + 3/16 * eps^3
        - 1/32 * eps^5
        + 19/2048 * eps^7
        - 3/4096 * eps^9;
C1[2] = - 1/16 * eps^2
        + 1/32 * eps^4
        - 9/2048 * eps^6
        + 7/4096 * eps^8
        + 1/65536 * eps^10;
C1[3] = - 1/48 * eps^3
        + 3/256 * eps^5
        - 3/2048 * eps^7
        + 17/24576 * eps^9;
C1[4] = - 5/512 * eps^4
        + 3/512 * eps^6
        - 11/16384 * eps^8
        + 3/8192 * eps^10;
C1[5] = - 7/1280 * eps^5
        + 7/2048 * eps^7
        - 3/8192 * eps^9;
C1[6] = - 7/2048 * eps^6
        + 9/4096 * eps^8
        - 117/524288 * eps^10;
C1[7] = - 33/14336 * eps^7
        + 99/65536 * eps^9;
C1[8] = - 429/262144 * eps^8
        + 143/131072 * eps^10;
C1[9] = - 715/589824 * eps^9;
C1[10] = - 2431/2621440 * eps^10;
\endverbatim

The function \e tau(\e sigma) = \e s/(\e b \e A1) = \e sigma + \e B1(\e
sigma) may be inverted by series reversion giving

&nbsp; &nbsp; \e sigma(\e tau) =
\e tau + sum<sub>\e j = 1</sub> \e C1'<sub>j</sub> sin(2 \e j \e tau)

where

\verbatim
C1'[1] = + 1/2 * eps
         - 9/32 * eps^3
         + 205/1536 * eps^5
         - 4879/73728 * eps^7
         + 9039/327680 * eps^9;
C1'[2] = + 5/16 * eps^2
         - 37/96 * eps^4
         + 1335/4096 * eps^6
         - 86171/368640 * eps^8
         + 4119073/28311552 * eps^10;
C1'[3] = + 29/96 * eps^3
         - 75/128 * eps^5
         + 2901/4096 * eps^7
         - 443327/655360 * eps^9;
C1'[4] = + 539/1536 * eps^4
         - 2391/2560 * eps^6
         + 1082857/737280 * eps^8
         - 2722891/1548288 * eps^10;
C1'[5] = + 3467/7680 * eps^5
         - 28223/18432 * eps^7
         + 1361343/458752 * eps^9;
C1'[6] = + 38081/61440 * eps^6
         - 733437/286720 * eps^8
         + 10820079/1835008 * eps^10;
C1'[7] = + 459485/516096 * eps^7
         - 709743/163840 * eps^9;
C1'[8] = + 109167851/82575360 * eps^8
         - 550835669/74317824 * eps^10;
C1'[9] = + 83141299/41287680 * eps^9;
C1'[10] = + 9303339907/2972712960 * eps^10;
\endverbatim

The reduced length is given by

&nbsp; &nbsp; \e m/\e b =
sqrt(1 + \e k<sup>2</sup> sin<sup>2</sup>\e sigma<sub>2</sub>)
cos \e sigma<sub>1</sub> sin \e sigma<sub>2</sub><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -
sqrt(1 + \e k<sup>2</sup> sin<sup>2</sup>\e sigma<sub>1</sub>)
sin \e sigma<sub>1</sub> cos \e sigma<sub>2</sub><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -
cos \e sigma<sub>1</sub>  cos \e sigma<sub>2</sub>
(\e J(\e sigma<sub>2</sub>) - \e J(\e sigma<sub>1</sub>))

where

&nbsp; &nbsp; \e J(\e sigma) =
\e I1(\e sigma) - \e I2(\e sigma)<br>
&nbsp; &nbsp; \e I2(\e sigma) = \e A2 (\e sigma + \e B2(\e sigma))<br>
&nbsp; &nbsp; \e B2(\e sigma) =
sum<sub>\e j = 1</sub> \e C2<sub>j</sub> sin(2 \e j \e sigma)

\verbatim
A2 = (1 + 1/4 * eps^2
        + 9/64 * eps^4
        + 25/256 * eps^6
        + 1225/16384 * eps^8
        + 3969/65536 * eps^10) * (1 - eps);
\endverbatim

\verbatim
C2[1] = + 1/2 * eps
        + 1/16 * eps^3
        + 1/32 * eps^5
        + 41/2048 * eps^7
        + 59/4096 * eps^9;
C2[2] = + 3/16 * eps^2
        + 1/32 * eps^4
        + 35/2048 * eps^6
        + 47/4096 * eps^8
        + 557/65536 * eps^10;
C2[3] = + 5/48 * eps^3
        + 5/256 * eps^5
        + 23/2048 * eps^7
        + 191/24576 * eps^9;
C2[4] = + 35/512 * eps^4
        + 7/512 * eps^6
        + 133/16384 * eps^8
        + 47/8192 * eps^10;
C2[5] = + 63/1280 * eps^5
        + 21/2048 * eps^7
        + 51/8192 * eps^9;
C2[6] = + 77/2048 * eps^6
        + 33/4096 * eps^8
        + 2607/524288 * eps^10;
C2[7] = + 429/14336 * eps^7
        + 429/65536 * eps^9;
C2[8] = + 6435/262144 * eps^8
        + 715/131072 * eps^10;
C2[9] = + 12155/589824 * eps^9;
C2[10] = + 46189/2621440 * eps^10;
\endverbatim

The longitude is given in terms of the spherical longitude by

&nbsp; &nbsp;
\e lambda = \e omega - \e f sin \e alpha<sub>0</sub> \e I3(\e sigma)

where

&nbsp; &nbsp; \e I3(\e sigma) = \e A3 (\e sigma + \e B3(\e sigma))<br>
&nbsp; &nbsp; \e B3(\e sigma) =
sum<sub>\e j = 1</sub> \e C3<sub>j</sub> sin(2 \e j \e sigma)

and

\verbatim
A3 = 1 - (1/2 - 1/2 * n) * eps
       - (1/4 + 1/8 * n - 3/8 * n^2) * eps^2
       - (1/16 + 3/16 * n + 1/16 * n^2 - 5/16 * n^3) * eps^3
       - (3/64 + 1/32 * n + 5/32 * n^2 + 5/128 * n^3 - 35/128 * n^4) * eps^4
       - (3/128 + 5/128 * n + 5/256 * n^2 + 35/256 * n^3 + 7/256 * n^4) * eps^5
       - (5/256 + 15/1024 * n + 35/1024 * n^2 + 7/512 * n^3) * eps^6
       - (25/2048 + 35/2048 * n + 21/2048 * n^2) * eps^7
       - (175/16384 + 35/4096 * n) * eps^8
       - 245/32768 * eps^9;
\endverbatim

\verbatim
C3[1] = + (1/4 - 1/4 * n) * eps
        + (1/8 - 1/8 * n^2) * eps^2
        + (3/64 + 3/64 * n - 1/64 * n^2 - 5/64 * n^3) * eps^3
        + (5/128 + 1/64 * n + 1/64 * n^2 - 1/64 * n^3 - 7/128 * n^4) * eps^4
        + (3/128 + 11/512 * n + 3/512 * n^2 + 1/256 * n^3 - 7/512 * n^4) * eps^5
        + (21/1024 + 5/512 * n + 13/1024 * n^2 + 1/512 * n^3) * eps^6
        + (243/16384 + 189/16384 * n + 83/16384 * n^2) * eps^7
        + (435/32768 + 109/16384 * n) * eps^8
        + 345/32768 * eps^9;
C3[2] = + (1/16 - 3/32 * n + 1/32 * n^2) * eps^2
        + (3/64 - 1/32 * n - 3/64 * n^2 + 1/32 * n^3) * eps^3
        + (3/128 + 1/128 * n - 9/256 * n^2 - 3/128 * n^3 + 7/256 * n^4) * eps^4
        + (5/256 + 1/256 * n - 1/128 * n^2 - 7/256 * n^3 - 3/256 * n^4) * eps^5
        + (27/2048 + 69/8192 * n - 39/8192 * n^2 - 47/4096 * n^3) * eps^6
        + (187/16384 + 39/8192 * n + 31/16384 * n^2) * eps^7
        + (287/32768 + 47/8192 * n) * eps^8
        + 255/32768 * eps^9;
C3[3] = + (5/192 - 3/64 * n + 5/192 * n^2 - 1/192 * n^3) * eps^3
        + (3/128 - 5/192 * n - 1/64 * n^2 + 5/192 * n^3 - 1/128 * n^4) * eps^4
        + (7/512 - 1/384 * n - 77/3072 * n^2 + 5/3072 * n^3 + 65/3072 * n^4) * eps^5
        + (3/256 - 1/1024 * n - 71/6144 * n^2 - 47/3072 * n^3) * eps^6
        + (139/16384 + 143/49152 * n - 383/49152 * n^2) * eps^7
        + (243/32768 + 95/49152 * n) * eps^8
        + 581/98304 * eps^9;
C3[4] = + (7/512 - 7/256 * n + 5/256 * n^2 - 7/1024 * n^3 + 1/1024 * n^4) * eps^4
        + (7/512 - 5/256 * n - 7/2048 * n^2 + 9/512 * n^3 - 21/2048 * n^4) * eps^5
        + (9/1024 - 43/8192 * n - 129/8192 * n^2 + 39/4096 * n^3) * eps^6
        + (127/16384 - 23/8192 * n - 165/16384 * n^2) * eps^7
        + (193/32768 + 3/8192 * n) * eps^8
        + 171/32768 * eps^9;
C3[5] = + (21/2560 - 9/512 * n + 15/1024 * n^2 - 7/1024 * n^3 + 9/5120 * n^4) * eps^5
        + (9/1024 - 15/1024 * n + 3/2048 * n^2 + 57/5120 * n^3) * eps^6
        + (99/16384 - 91/16384 * n - 781/81920 * n^2) * eps^7
        + (179/32768 - 55/16384 * n) * eps^8
        + 141/32768 * eps^9;
C3[6] = + (11/2048 - 99/8192 * n + 275/24576 * n^2 - 77/12288 * n^3) * eps^6
        + (99/16384 - 275/24576 * n + 55/16384 * n^2) * eps^7
        + (143/32768 - 253/49152 * n) * eps^8
        + 33/8192 * eps^9;
C3[7] = + (429/114688 - 143/16384 * n + 143/16384 * n^2) * eps^7
        + (143/32768 - 143/16384 * n) * eps^8
        + 429/131072 * eps^9;
C3[8] = + (715/262144 - 429/65536 * n) * eps^8
        + 429/131072 * eps^9;
C3[9] = + 2431/1179648 * eps^9;
\endverbatim

The formula for area between the geodesic and the equator is given in
Sec. 15 of
<a href="http://arxiv.org/abs/1102.1215">arxiv:1102.1215</a>
in terms of \e S,

&nbsp; &nbsp;
\e S = \e c<sup>2</sup> \e alpha + \e e<sup>2</sup> \e a<sup>2</sup>
cos \e alpha<sub>0</sub> sin \e alpha<sub>0</sub> \e I4(\e sigma)

where

&nbsp; &nbsp; \e I4(\e sigma) =
sum<sub>\e j = 0</sub> \e C4<sub>j</sub> cos((2\e j + 1) \e sigma)

with

\verbatim
C4[0] = + (2/3 - 1/15 * ep2 + 4/105 * ep2^2 - 8/315 * ep2^3 + 64/3465 * ep2^4 - 128/9009 * ep2^5 + 512/45045 * ep2^6 - 1024/109395 * ep2^7 + 16384/2078505 * ep2^8 - 32768/4849845 * ep2^9)
        - (1/20 - 1/35 * ep2 + 2/105 * ep2^2 - 16/1155 * ep2^3 + 32/3003 * ep2^4 - 128/15015 * ep2^5 + 256/36465 * ep2^6 - 4096/692835 * ep2^7 + 8192/1616615 * ep2^8) * k2
        + (1/42 - 1/63 * ep2 + 8/693 * ep2^2 - 80/9009 * ep2^3 + 64/9009 * ep2^4 - 128/21879 * ep2^5 + 2048/415701 * ep2^6 - 4096/969969 * ep2^7) * k2^2
        - (1/72 - 1/99 * ep2 + 10/1287 * ep2^2 - 8/1287 * ep2^3 + 112/21879 * ep2^4 - 1792/415701 * ep2^5 + 512/138567 * ep2^6) * k2^3
        + (1/110 - 1/143 * ep2 + 4/715 * ep2^2 - 56/12155 * ep2^3 + 896/230945 * ep2^4 - 768/230945 * ep2^5) * k2^4
        - (1/156 - 1/195 * ep2 + 14/3315 * ep2^2 - 224/62985 * ep2^3 + 64/20995 * ep2^4) * k2^5
        + (1/210 - 1/255 * ep2 + 16/4845 * ep2^2 - 32/11305 * ep2^3) * k2^6
        - (1/272 - 1/323 * ep2 + 6/2261 * ep2^2) * k2^7
        + (1/342 - 1/399 * ep2) * k2^8
        - 1/420 * k2^9;
C4[1] = + (1/180 - 1/315 * ep2 + 2/945 * ep2^2 - 16/10395 * ep2^3 + 32/27027 * ep2^4 - 128/135135 * ep2^5 + 256/328185 * ep2^6 - 4096/6235515 * ep2^7 + 8192/14549535 * ep2^8) * k2
        - (1/252 - 1/378 * ep2 + 4/2079 * ep2^2 - 40/27027 * ep2^3 + 32/27027 * ep2^4 - 64/65637 * ep2^5 + 1024/1247103 * ep2^6 - 2048/2909907 * ep2^7) * k2^2
        + (1/360 - 1/495 * ep2 + 2/1287 * ep2^2 - 8/6435 * ep2^3 + 112/109395 * ep2^4 - 1792/2078505 * ep2^5 + 512/692835 * ep2^6) * k2^3
        - (1/495 - 2/1287 * ep2 + 8/6435 * ep2^2 - 112/109395 * ep2^3 + 1792/2078505 * ep2^4 - 512/692835 * ep2^5) * k2^4
        + (5/3276 - 1/819 * ep2 + 2/1989 * ep2^2 - 32/37791 * ep2^3 + 64/88179 * ep2^4) * k2^5
        - (1/840 - 1/1020 * ep2 + 4/4845 * ep2^2 - 8/11305 * ep2^3) * k2^6
        + (7/7344 - 7/8721 * ep2 + 2/2907 * ep2^2) * k2^7
        - (2/2565 - 4/5985 * ep2) * k2^8
        + 1/1540 * k2^9;
C4[2] = + (1/2100 - 1/3150 * ep2 + 4/17325 * ep2^2 - 8/45045 * ep2^3 + 32/225225 * ep2^4 - 64/546975 * ep2^5 + 1024/10392525 * ep2^6 - 2048/24249225 * ep2^7) * k2^2
        - (1/1800 - 1/2475 * ep2 + 2/6435 * ep2^2 - 8/32175 * ep2^3 + 112/546975 * ep2^4 - 1792/10392525 * ep2^5 + 512/3464175 * ep2^6) * k2^3
        + (1/1925 - 2/5005 * ep2 + 8/25025 * ep2^2 - 16/60775 * ep2^3 + 256/1154725 * ep2^4 - 1536/8083075 * ep2^5) * k2^4
        - (1/2184 - 1/2730 * ep2 + 1/3315 * ep2^2 - 16/62985 * ep2^3 + 32/146965 * ep2^4) * k2^5
        + (1/2520 - 1/3060 * ep2 + 4/14535 * ep2^2 - 8/33915 * ep2^3) * k2^6
        - (7/20400 - 7/24225 * ep2 + 2/8075 * ep2^2) * k2^7
        + (14/47025 - 4/15675 * ep2) * k2^8
        - 1/3850 * k2^9;
C4[3] = + (1/17640 - 1/24255 * ep2 + 2/63063 * ep2^2 - 8/315315 * ep2^3 + 16/765765 * ep2^4 - 256/14549535 * ep2^5 + 512/33948915 * ep2^6) * k2^3
        - (1/10780 - 1/14014 * ep2 + 2/35035 * ep2^2 - 4/85085 * ep2^3 + 64/1616615 * ep2^4 - 384/11316305 * ep2^5) * k2^4
        + (5/45864 - 1/11466 * ep2 + 1/13923 * ep2^2 - 16/264537 * ep2^3 + 32/617253 * ep2^4) * k2^5
        - (1/8820 - 1/10710 * ep2 + 8/101745 * ep2^2 - 16/237405 * ep2^3) * k2^6
        + (1/8976 - 1/10659 * ep2 + 2/24871 * ep2^2) * k2^7
        - (1/9405 - 2/21945 * ep2) * k2^8
        + 1/10010 * k2^9;
C4[4] = + (1/124740 - 1/162162 * ep2 + 2/405405 * ep2^2 - 4/984555 * ep2^3 + 64/18706545 * ep2^4 - 128/43648605 * ep2^5) * k2^4
        - (1/58968 - 1/73710 * ep2 + 1/89505 * ep2^2 - 16/1700595 * ep2^3 + 32/3968055 * ep2^4) * k2^5
        + (1/41580 - 1/50490 * ep2 + 8/479655 * ep2^2 - 16/1119195 * ep2^3) * k2^6
        - (7/242352 - 7/287793 * ep2 + 2/95931 * ep2^2) * k2^7
        + (7/220077 - 2/73359 * ep2) * k2^8
        - 1/30030 * k2^9;
C4[5] = + (1/792792 - 1/990990 * ep2 + 1/1203345 * ep2^2 - 16/22863555 * ep2^3 + 32/53348295 * ep2^4) * k2^5
        - (1/304920 - 1/370260 * ep2 + 4/1758735 * ep2^2 - 8/4103715 * ep2^3) * k2^6
        + (7/1283568 - 7/1524237 * ep2 + 2/508079 * ep2^2) * k2^7
        - (2/268983 - 4/627627 * ep2) * k2^8
        + 1/110110 * k2^9;
C4[6] = + (1/4684680 - 1/5688540 * ep2 + 4/27020565 * ep2^2 - 8/63047985 * ep2^3) * k2^6
        - (1/1516944 - 1/1801371 * ep2 + 2/4203199 * ep2^2) * k2^7
        + (2/1589445 - 4/3708705 * ep2) * k2^8
        - 1/520520 * k2^9;
C4[7] = + (1/26254800 - 1/31177575 * ep2 + 2/72747675 * ep2^2) * k2^7
        - (1/7335900 - 1/8558550 * ep2) * k2^8
        + 1/3403400 * k2^9;
C4[8] = + (1/141338340 - 1/164894730 * ep2) * k2^8
        - 1/34714680 * k2^9;
C4[9] = + 1/737176440 * k2^9;
\endverbatim

<center>
Back to \ref transversemercator.  Forward to \ref geocentric.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page geocentric Geocentric coordinates

<center>
Back to \ref geodesic.  Forward to \ref geoid.  Up to \ref contents.
</center>

The implementation of GeographicLib::Geocentric::Reverse is adapted from
 - H. Vermeille,
   <a href="http://dx.doi.org/10.1007/s00190-002-0273-6">
   Direct transformation from geocentric coordinates to geodetic
   coordinates</a>, J. Geodesy 76, 451&ndash;454 (2002).

This provides a closed-form solution but can't directly be applied close to
the center of the earth.  Several changes have been made to remove this
restriction and to improve the numerical accuracy.  Now the method is
accurate for all inputs (even if \e h is infinite).  The changes are
described in Appendix B of
 - C. F. F. Karney,
   <a href="http://arxiv.org/abs/1102.1215">Geodesics
   on an ellipsoid of revolution</a>,
   Feb. 2011.

The problems encountered near the center of the ellipsoid are:
 - There's a potential division by zero in the definition of \e s. The
   equations are easily reformulated to avoid this problem.
 - \e t<sup>3</sup> may be negative.  This is OK; we just take the real root.
 - The solution for \e t may be complex.  However this leads to 3 real roots
   for \e u/\e r.  It's then just a matter of picking the one that computes
   the geodetic result which minimizes |\e h| and which avoids large
   round-off errors.
 - Some of the equations result in a large loss of accuracy due to
   subtracting nearly equal quantities.  E.g., \e k= sqrt(\e u + \e v + \e
   w<sup>2</sup>) - \e w is inaccurate if \e u + \e v is small; we can fix
   this by writing \e k = (\e u + \e v)/(sqrt(\e u + \e v + \e w<sup>2</sup>)
   + \e w).

The error is computed as follows.  Write a version of
Geocentric::WGS84.Forward which uses long doubles (including using long
doubles for the WGS84 parameters).  Generate random (long double) geodetic
coordinates (\e lat0, \e lon0, \e h0) and use the "long double"
WGS84.Forward to obtain the corresponding (long double) geocentric
coordinates (\e x0, \e y0, \e z0).  [We restrict \e h0 so that \e h0 >= - \e
a (1 - \e e<sup>2</sup>) / sqrt(1 - \e e<sup>2</sup> sin<sup>2</sup>\e
lat0), which ensures that (\e lat0, \e lon0, \e h0) is the principal
geodetic inverse of (\e x0, \e y0, \e z0).]  Because the forward calculation
is numerically stable and because long doubles (on Linux systems using g++)
provide 11 bits additional accuracy (about 3.3 decimal digits), we regard
this set of test data as exact.

Apply the double version of WGS84.Reverse to (\e x0, \e y0, \e z0) to
compute the approximate geodetic coordinates (\e lat1, \e lon1, \e h1).
Convert (\e lat1 - \e lat0, \e lon1 - \e lon0) to a distance, \e ds, on the
surface of the ellipsoid and define \e err = hypot(\e ds, \e h1 - \e h0).
For |\e h0| < 5000 km, we have \e err < 7 nm.

This methodology is not very useful very far from the globe, because the
absolute errors in the approximate geodetic height become large, or within
50 km of the center of the earth, because of errors in computing the
approximate geodetic latitude.  To illustrate the second issue, the maximum
value of \e err for \e h0 < 0 is about 80 mm.  The error is maximum close to
the circle given by geocentric coordinates satisfying hypot(\e x, \e y) = \e
a \e e<sup>2</sup> (= 42.7 km), \e z = 0.  (This is the center of meridional
curvature for \e lat = 0.)  The geodetic latitude for these points is \e lat
= 0.  However, if we move 1 nm towards the center of the earth, the geodetic
latitude becomes 0.04", a distance of 1.4 m from the equator.  If, instead,
we move 1 nm up, the geodetic latitude becomes 7.45", a distance of 229 m
from the equator.  In light of this, Reverse does quite well in this
vicinity.

To obtain a practical measure of the error for the general case we define
- <i>err</i><sub>h</sub> = |\e h1 - \e h0| / max(1, \e h0 / \e a)
- for \e h0 > 0, <i>err</i><sub>out</sub> = \e ds
- for \e h0 < 0, apply the long double version of WGS84.Forward to (\e lat1,
  \e lon1, \e h1) to give (\e x1, \e y1, \e z1) and compute
  <i>err</i><sub>in</sub> = hypot(\e x1 - \e x0, \e y1 - \e y0, \e z1 - \e
  z0).
.
We then find <i>err</i><sub>h</sub> < 8 nm, <i>err</i><sub>out</sub> < 4 nm,
and <i>err</i><sub>in</sub> < 7 nm.

The testing has been confined to the WGS84 ellipsoid.  The method will work
for all ellipsoids used in terrestrial geodesy.  However, the central region,
which leads to multiple real roots for the cubic equation in Reverse, pokes
outside the ellipsoid (at the poles) for ellipsoids with \e e > 1/sqrt(2).
Reverse has not been analysed for this case.  Similarly ellipsoids which are
very nearly spherical near yield inaccurate results due to underflow; in the
other hand, the case of the sphere, \e f = 0, is treated specially and gives
accurate results.

Other comparable methods are K. M. Borkowski,
<a href="http://dx.doi.org/10.1007/BF00643807"> Transformation
of geocentric to geodetic coordinates without approximations</a>,
Astrophys. Space Sci. 139, 1&ndash;4 (1987)
(<a href="http://dx.doi.org/10.1007/BF00656995"> erratum</a>)
and T. Fukushima,
<a href="http://dx.doi.org/10.1007/s001900050271"> Fast transform from
geocentric to geodetic coordinates</a>, J. Geodesy 73, 603&ndash;610 (2003).
However the choice of independent variables in these methods leads
to a loss of accuracy for points near the equatorial plane.

<center>
Back to \ref geodesic.  Forward to \ref geoid.  Up to \ref contents.

</center>
**********************************************************************/
/**
\page geoid Geoid height

<center>
Back to \ref geocentric.  Forward to \ref utilities.  Up to \ref contents.
</center>

The gravitational equipotential surface approximately coinciding with
mean sea level is called the geoid.  The GeographicLib::Geoid class
evaluates the height of the geoid above the WGS84 ellipsoid.  This can
be used to convert heights above mean sea level to heights above the
WGS84 ellipoid.  Because the normal to the ellipsoid differs from the
normal to the geoid (the direction of a plumb line) there is a slight
ambiguity in the measurement of heights; however for heights up to 10km
this ambiguity is only 1mm.

The geoid is usually approximated by an "earth gravity model".  The
models published by the NGA are:
- EGM84:
  http://earth-info.nga.mil/GandG/wgs84/gravitymod/wgs84_180/wgs84_180.html
- EGM96:
  http://earth-info.nga.mil/GandG/wgs84/gravitymod/egm96/egm96.html
- EGM2008:
  http://earth-info.nga.mil/GandG/wgs84/gravitymod/egm2008
.
GeographicLib::Geoid offers a uniform way to handle all 3 geoids at a
variety of grid resolutions.  (In contrast, the software tools that NGA
offers are different for each geoid, and the interpolation programs are
different for each grid resolution.  In addition these tools are written
in Fortran with is nowadays difficult to integrate with other software.)

Unlike other components of %GeographicLib, there is a appreciable error
in the results obtained (at best, the RMS error is 1mm).  However the
class provides methods to report the maximum and RMS errors in the
results.

The class also returns the gradient of the geoid.  This can be used to
estimate the direction of a plumb line relative to the WGS84 ellipsoid.

\section geoidinst Installing the datasets

The geoid heights are computed using interpolation into a rectangular
grid.  The grids are read from data files which have been are computed
using the NGA synthesis programs in the case of the EGM84 and EGM96
models and using the NGA binary gridded data files in the case of
EGM2008.  These data files are available for download:
- EGM84,    30' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm84-30.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm84-30.zip/download">zip</a>.
- EGM84,    15' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm84-15.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm84-15.zip/download">zip</a>.
- EGM96,    15' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm96-15.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm96-15.zip/download">zip</a>.
- EGM96,     5' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm96-5.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm96-5.zip/download">zip</a>.
- EGM2008,   5' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-5.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-5.zip/download">zip</a>.
- EGM2008, 2.5' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-2_5.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-2_5.zip/download">zip</a>.
- EGM2008,   1' grid:
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-1.tar.bz2/download">tar.bz2</a>,
  <a href="http://sf.net/projects/geographiclib/files/geoids-distrib/egm2008-1.zip/download">zip</a>.

Download \e either the tar.bz2 file \e or zip file (they have the same
contents).  If possible use the tar.bz2 format, since bzip2 compresses
these files about 2 times better than zip.  The data in tar and zip
files both unpack into a "geoids" directory and, for convenience, all
the data should be unpacked in the same parent directory.  For example
\verbatim
   mkdir -p /usr/local/share/GeographicLib
   tar xfjC egm96-5.tar.bz2 /usr/local/share/GeographicLib
   tar xfjC egm2008-2_5.tar.bz2 /usr/local/share/GeographicLib
   etc.
\endverbatim
or
\verbatim
   mkdir -p /usr/local/share/GeographicLib
   cd /usr/local/share/GeographicLib
   unzip ~-/egm96-5.zip
   unzip ~-/egm2008-2_5.zip
   etc.
\endverbatim
Geoid uses a compile time default (specified by the GEOID_DEFAULT_PATH
macro) to locate the datasets.  This is
- /usr/local/share/GeographicLib/geoids, for non-Windows systems
- C:/cygwin/usr/local/share/GeographicLib/geoids, for Windows systems
.
This may be overridden at run-time by defining the GEOID_PATH
environment variable.  Finally, the path may be set using the optional
second argument to the GeographicLib::Geoid::Geoid constructor.

The sizes of these datasets are
\verbatim
   name         geoid    grid           sizes (MB)
                                 tar.bz2    zip    disk
   egm84-30     EGM84    30'      0.5       0.5     0.5
   egm84-15     EGM84    15'      1.5       1.9     2.0
   egm96-15     EGM96    15'      1.5       1.9     2.0
   egm96-5      EGM96     5'      9.8        16      18
   egm2008-5    EGM2008   5'       10        16      18
   egm2008-2_5  EGM2008   2.5'     34        62      72
   egm2008-1    EGM2008   1'      155       372     445
\endverbatim
The final "disk" column is the size of the uncompressed data and it also
gives the memory requirements for caching the entire dataset using the
GeographicLib::Geoid::CacheAll method.

\section geoidformat The format of the geoid data files

The gridded data used by the GeographicLib::Geoid class is stored in
16-bit PGM files.  Thus the data for egm96-5 might be stored in the file
- /usr/local/share/GeographicLib/geoids/egm96-5.pgm
.
PGM simple graphic format with the following properties
- it is well documented
  <a href="http://netpbm.sf.net/doc/pgm.html">here</a>;
- there are no separate "little-endian" and "big-endian" versions;
- it uses 1 or 2 bytes per pixel;
- pixels can be randomly accessed;
- comments can be added to the file header;
- it is sufficiently simple that it can be easily read without using the
  <a href="http://netpbm.sf.net/doc/libnetpbm.html">libnetpbm</a>
  library (and thus we avoid adding a software dependency to
  %GeographicLib).
.
The major drawback of this format is that since there are only 65535
possible pixel values, the height must be quantized to 3mm.  However,
the resulting quantization error (up to 1.5mm) is typically smaller than
the linear interpolation errors.  The comments in the header for
egm96-5 are
\verbatim
   # Geoid file in PGM format for the GeographicLib::Geoid class
   # Description WGS84 EGM96, 5-minute grid
   # URL http://earth-info.nga.mil/GandG/wgs84/gravitymod/egm96/egm96.html
   # DateTime 2009-08-29 18:45:03
   # MaxBilinearError 0.140
   # RMSBilinearError 0.005
   # MaxCubicError 0.003
   # RMSCubicError 0.001
   # Offset -108
   # Scale 0.003
   # Origin 90N 0E
   # AREA_OR_POINT Point
   # Vertical_Datum WGS84
\endverbatim
Of these lines, the Scale and Offset lines are required and define the
conversion from pixel value to height (in meters) using \e height =
\e offset + \e scale \e pixel.  The Geoid constructor also reads the
Description, DataTime, and error lines (if present) and stores the
resulting data so that it can be returned by
GeographicLib::Geoid::Description, GeographicLib::Geoid::DateTime,
GeographicLib::Geoid::MaxError, and GeographicLib::Geoid::RMSError
methods.  The other lines serve as additional documentation but are not
used by this class.  Accompanying egm96-5.pgm (and similarly with the
other geoid data files) are two files egm96-5.wld and
egm96-5.pgm.aux.xml.  The first is an ESRI "world" file and the second
supplies complete projection metadata for use by
<a href="http://www.gdal.org">GDAL</a>.  Neither of these files is read
by GeographicLib::Geoid.

You can use gdal_translate to convert the data files to a standard
GeoTiff, e.g., with
\verbatim
   gdal_translate -ot Float32 -scale 0 65000 -108 87 egm96-5.pgm egm96-5.tif
\endverbatim
The arguments to -scale here are specific to the Offset and Scale
parameters used in the pgm file (note 65000 * 0.003 - 108 = 87).  You
can check these by running <a href="GeoidEval.1.html">GeoidEval</a> with
the "-v" option.

Finally, here is a sample script which uses GDAL to create a 1-degree
squared grid of geoid heights at 3&quot; resolution (matching DTED1) by
bilinear interpolation.
\verbatim
   #! /bin/sh
   lat=37
   lon=067
   res=3                           # resolution in seconds
   TEMP=`mktemp junkXXXXXXXXXX`    # temporary file for GDAL
   gdalwarp -q -te `echo $lon $lat $res | awk '{
       lon = $1; lat = $2; res = $3;
       printf "%.14f %.14f %.14f %.14f",
           lon  -0.5*res/3600, lat  -0.5*res/3600,
           lon+1+0.5*res/3600, lat+1+0.5*res/3600;
   }'` -ts $((3600/res+1)) $((3600/res+1)) -r bilinear egm96-5.tif $TEMP
   gdal_translate -quiet \
       -mo AREA_OR_POINT=Point \
       -mo Description="WGS84 EGM96, $res-second grid" \
       -mo Vertical_Datum=WGS84 \
       -mo Tie_Point_Location=pixel_corner \
       $TEMP e$lon-n$lat.tif
   rm -f $TEMP
\endverbatim

\section geoidinterp Interpolating the geoid data

GeographicLib::Geoid evaluates the geoid height is by bilinear or cubic
interpolation.  The gradient of the geoid height is obtained by
differentiating the interpolated height and referencing the result to
distance on the WGS84 ellipsoid.

The bilinear interpolation is based on the values at the 4 corners of
the enclosing cell.  The interpolated height is a continuous function of
position; however the gradient has discontinuities are cell boundaries.
The quantization of the data files exacerbates the errors in the
gradients.

The cubic interpolation is a least-squares fit to the values on a
12-point stencil with weights as follows:
\verbatim
   . 1 1 .
   1 2 2 1
   1 2 2 1
   . 1 1 .
\endverbatim
The cubic is constrained to be independent of longitude when evaluating
the height at one of the poles.  Cubic interpolation is considerably
more accurate than bilinear interpolation; however, in this
implementation there are small discontinuities in the heights are cell
boundaries.  The over-constrained cubic fit slightly reduces the
quantization errors on average.

The algorithm for the least squares fit is taken from, F. H. Lesh,
Multi-dimensional least-squares polynomial curve fitting, CACM 2, 29-30
(1959).  This algorithm is not part of Geographic::Geoid; instead it is
implemented as
<a href="http://en.wikipedia.org/wiki/Maxima_(software)">Maxima</a>
code which is used to precompute the matrices to convert the function
values on the stencil into the coefficients from the cubic polynomial.
This code is included as a comment in Geoid.cpp.

The interpolations methods are quick and give good accuracy.  Here is a
summary of the combined quantization and interpolation errors for the
heights.
\verbatim
                                  bilinear error    cubic error
   name         geoid    grid     max     rms       max     rms
   egm84-30     EGM84    30'      1.546m  70mm      0.274m  14mm
   egm84-15     EGM84    15'      0.413m  18mm      0.020m   1mm
   egm96-15     EGM96    15'      1.152m  40mm      0.169m   7mm
   egm96-5      EGM96     5'      0.140m   5mm      0.003m   1mm
   egm2008-5    EGM2008   5'      0.478m  12mm      0.294m   5mm
   egm2008-2_5  EGM2008   2.5'    0.135m   3mm      0.031m   1mm
   egm2008-1    EGM2008   1'      0.025m   1mm      0.003m   1mm
\endverbatim
The errors are with respect the the specific NGA earth gravity model
(not to any "real" geoid).  The RMS values are obtained using 5 million
uniformly distributed random points.  The maximum values are obtained by
evaluating the errors using a different grid with points at or near the
centers of the original grid.  (The RMS difference between EGM96 and
EGM2008 is about 0.5m.  The RMS difference between EGM84 and EGM96 is
about 1.5m.)

\section geoidcache Caching the geoid data

A simple way of calling Geoid is as follows
\code
   #include "GeographicLib/Geoid.hpp"
   #include <iostream>
   ...
   GeographicLib::Geoid g("egm96-5");
   double lat, lon;
   while (std::cin >> lat >> lon)
      std::cout << g(lat, lon) << "\n";
   ...
\endcode

The first call to g(lat, lon) causes the data for the stencil points (4
points for bilinear interpolation and 12 for cubic interpolation) to be
read and the interpolated value returned.  A simple 0th-order caching
scheme is provided by default, so that, if the second and subsequent
points falls within the same grid cell, the data values are not reread
from the file.  This is adequate for most interactive use and also
minimizes disk accesses for the case when a continuous track is being
followed.

If a large quantity of geoid calculations are needed, the calculation
can be speeded up by preloading the data for a rectangular block with
GeographicLib::Geoid::CacheArea or the entire dataset with
GeographicLib::Geoid::CacheAll.  If the requested points lie within the
cached area, the cached data values are used; otherwise the data is read
from disk as before.  Caching all the data is a reasonable choice for
the 5' grids and coarser.  Caching all the data for the 1' grid will
require 0.5GB of RAM and should only be used on systems with sufficient
memory.

The use of caching does not affect the values returned.  Because
of the caching and the random file access, this class is \e not
thread safe; i.e., a single instantiation cannot be safely used
by multiple threads.  If multiple threads need to calculate
geoid heights they should all construct thread-local
instantiations.

\section testgeoid Test data for geoids

A test set for the geoid models is available at
 - <a href="http://sf.net/projects/geographiclib/files/testdata/GeoidHeights.dat.gz/download">
   GeoidHeight.dat.gz</a>
 .
This is about 10 MB (compressed).  This test set consists of a set of
500000 geographic coordinates together with the corresponding geoid
heights according to various earth gravity models.

Each line of the test set gives 6 space delimited numbers
 - latitude (degrees, exact)
 - longitude (degrees, exact)
 - EGM84 height (meters, accurate to 1 mm)
 - EGM96 height (meters, accurate to 0.1 mm)
 - EGM2008 height (meters, accurate to 1 mm)
 .
The latitude and longitude are all multiples of 10<sup>-6</sup> deg and
should be regarded as exact.  The geoid heights are computed using the
harmonic NGA synthesis programs.  In the case of the EGM84 and EGM96,
the programs were compiled (with gfortran) and run under Linux.  In the
case of EGM2008, the prescription results in NaNs (possibly because of
uninitialized variables in the program?), so the data was generated with
the precompiled binary that NGA supplies for Windows.

<center>
Back to \ref geocentric.  Forward to \ref utilities.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page utilities Utility Programs

<center>
Back to \ref geocentric.  Forward to \ref old.  Up to \ref contents.
</center>

Various utility programs are provided with %GeographicLib.  These should
be installed in a directory included in your PATH (e.g.,
/usr/local/bin).  These programs are merely wrapper programs that invoke
the underlying functionality provided by the library.  The utilities all
accept data on standard input, transform it in some way, and print the
results on standard output.  This makes the utilities easy to use within
scripts to transform tabular data; however they can also be used
interactively, often with the input supplied via a pipe, e.g.,

 - echo 38SMB4488 | GeoConvert -d

The utlilities are

 - <a href="GeoConvert.1.html"><b>GeoConvert</b></a>: convert geographic
   coordinates using GeographicLib::GeoCoords.  There is an online
   interface to this utility at
   http://geographiclib.sf.net/cgi-bin/GeoConvert
 - <a href="Geod.1.html"><b>Geod</b></a>: perform geodesic calculations
   using GeographicLib::Geodesic and GeographicLib::GeodesicLine.  There
   is an online interface to this utility at
   http://geographiclib.sf.net/cgi-bin/Geod
 - <a href="Planimeter.1.html"><b>Planimeter</b></a>: compute the area of
   geodesic polygons using the area facilities provided by
   GeographicLib::Geodesic.
 - <a href="TransverseMercatorTest.1.html"><b>TransverseMercatorTest</b></a>:
   convert between geographic and transverse Mercator.  This is for testing
   GeographicLib::TransverseMercatorExact and
   GeographicLib::TransverseMercator.
 - <a href="CartConvert.1.html"><b>CartConvert</b></a>: convert geodetic
   coordinates to geocentric or local cartesian using
   GeographicLib::Geocentric and GeographicLib::LocalCartesian.
 - <a href="EquidistantTest.1.html"><b>EquidistantTest</b></a>: perform
   projections based on geodesics using
   GeographicLib::AzimuthalEquidistant, GeographicLib::Gnomonic, and
   GeographicLib::CassiniSoldner.
 - <a href="GeoidEval.1.html"><b>GeoidEval</b></a>: look up geoid
   heights using GeographicLib::Geoid.  There is an online interface to
   this utility at http://geographiclib.sf.net/cgi-bin/GeoidEval
 .
Click on the utility name to read the documentation for the utility.

<center>
Back to \ref geocentric.  Forward to \ref old.  Up to \ref contents.
</center>
**********************************************************************/
/**
\page old Old Versions

<center>
Back to \ref utilities.  Up to \ref contents.
</center>

List of versions in reverse chronological order together with a brief
list of changes.  (Note: Old versions of the library use a year-month
style of numbering.  Now, the library uses a major and minor version
number.)

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.7.tar.gz/download">1.8 (not released yet)</a>
  - Add 64-bit targets for Visual Studio 2010.
  - Use templates for defining math functions and some constants.
  - Use Kahan summation in <a href="Planimeter.1.html">Planimeter</a>.
  - Add GeographicLib::Geoid::DefaultGeoidPath and
    GeographicLib::Geoid::DefaultGeoidName.
  - <a href="GeoidEval.1.html">GeoidEval</a> uses environment variable
    GEOID_NAME as the default geoid.
  - Update references for Helmert, transverse Mercator paper.
  - Add --msltohae and --haetomsl as
    <a href="GeoidEval.1.html">GeoidEval</a> options (and don't document
    the single hyphen versions).
  - Optionally return rotation matrix from GeographicLib::Geocentric and
    GeographicLib::LocalCartesian.
  - Supply man pages.  With the utilitiies, -h prints the synopsis and
    --help prints the man page.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.7.tar.gz/download">1.7 (current, released 2010-12-21)</a>
  - FIX BUG in scale returned by GeographicLib::LambertConformalConic::Reverse.
  - Add GeographicLib::AlbersEqualArea projection.
  - Library created by Visual Studio is Geographic.lib instead of
    GeographicLib.lib (compatible with makefiles).
  - Make classes NaN aware.
  - Use cell arrays for MGRS strings in Matlab.
  - Add solution/project files for Visual Studio 2010 (32-bit only).
  - Use C++0x static_assert and math functions, if available.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.6.tar.gz/download">1.6 (released 2010-11-23)</a>
  - FIX BUG introduced in GeographicLib::Geoid in version 1.5 (found by
    Dave Edwards).

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.5.tar.gz/download">1.5 (released 2010-11-19)</a>
  - Improve area calculations for small polygons.
  - Add -s and -r flags to <a href="Planimeter.1.html">Planimeter</a>.
  - Improve the accuracy of GeographicLib::LambertConformalConic using
    divided differences.
  - FIX BUG in meridian convergence returned by
    LambertConformalConic::Forward.
  - Add optional threadsafe parameter to GeographicLib::Geoid
    constructor.  WARNING: This changes may break binary compatibility
    with previous versions of %GeographicLib.  However, the library is
    source compatible.
  - Add GeographicLib::OSGB.
  - Matlab and Octave interfaces to GeographicLib::UTMUPS,
    GeographicLib::MGRS, GeographicLib::Geoid, GeographicLib::Geodesic
    provided.
  - Minor changes
    - explicitly turn on optimization in Visual Studio 2008 projects;
    - add missing dependencies in some Makefiles;
    - move pi() and degree() from GeographicLib::Constants to
      GeographicLib::Math;
    - introduce GeographicLib::Math::extended type to aid testing;
    - add GeographicLib::Math::epi() and GeographicLib::Math::edegree().
    - fixes to compile under cygwin;
    - tweak expression used to find latitude from conformal latitude.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.4.tar.gz/download">1.4 (released 2010-09-12)</a>
  - Changes to GeographicLib::Geodesic and GeographicLib::GeodesicLine:
    - FIX BUG in Geodesic::Inverse with prolate ellipsoids;
    - add area computations to Geodesic::Direct and Geodesic::Inverse;
    - add geodesic areas to geodesic test set;
    - make GeodesicLine constructor public;
    - change longitude series in Geodesic into Helmert-like form;
    - ensure that equatorial geodesics have cos(alpha0) = 0 identically;
    - generalize interface for Geodesic and GeodesicLine;
    - split GeodesicLine and Geodesic into different files;
    - signal convergence failure in Geodesic::Inverse with NaNs;
    - deprecate one function in Geodesic and two functions in
      GeodesicLine;
    - deprecate -n option for <a href="Geod.1.html">Geod</a>.
    .
    WARNING: These changes may break binary compatibility with previous
    versions of %GeographicLib.  However, the library is source
    compatible (with the proviso that GeographicLib/GeodesicLine.hpp may
    now need to be included).
  - Add the <a href="Planimeter.1.html">Planimeter</a> utility for
    computing the areas of geodesic polygons.
  - Improve iterative solution of GeographicLib::Gnomonic::Reverse.
  - Add GeographicLib::Geoid::ConvertHeight.
  - Add -msltohae, -haetomsl, and -z options to
    <a href="GeoidEval.1.html">GeoidEval</a>.
  - Constructors check that minor radius is positive.
  - Add overloaded Forward and Reverse functions to the projection
    classes which don't return the convergence (or azimuth) and scale.
  - Document function parameters and return values consistently.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.3.tar.gz/download">1.3 (released 2010-07-21)</a>
  - Add GeographicLib::Gnomonic, the ellipsoid generalization of the
    gnomonic projection.
  - Add -g and -e options to
    <a href="EquidistantTest.1.html">EquidistantTest</a>.
  - Use fixed-point notation for output from
    <a href="CartConvert.1.html">CartConvert</a>,
    <a href="EquidistantTest.1.html">EquidistantTest</a>,
    <a href="TransverseMercatorTest.1.html">TransverseMercatorTest</a>.
  - PolarStereographic:
    - Improved conversion to conformal coordinates;
    - Fix bug with scale at opposite pole;
    - Complain if latitude out of range in SetScale.
  - Add GeographicLib::Math::NaN().
  - Add long double version of hypot for Windows.
  - Add EllipticFunction::E(real).
  - Update references to Geotrans in MGRS documentation.
  - Speed up tmseries.mac.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.2.tar.gz/download">1.2 (released 2010-05-21)</a>
  - FIX BUGS in GeographicLib::Geodesic,
    - wrong azimuth returned by Direct if point 2 is on a pole;
    - Inverse sometimes fails with very close points.
  - Improve calculation of scale in GeographicLib::CassiniSoldner,
    - add GeographicLib::GeodesicLine::Scale,
      GeographicLib::GeodesicLine::EquatorialAzimuth, and
      GeographicLib::GeodesicLine::EquatorialArc;
    - break friend connection between CassiniSoldner and Geodesic.
  - Add GeographicLib::DMS::DecodeAngle and
    GeographicLib::DMS::DecodeAzimuth.  Extend
    GeographicLib::DMS::Decode and GeographicLib::DMS::Encode to deal
    with distances.
  - Code and documentation changes in GeographicLib::Geodesic and
    GeographicLib::Geocentric for consistency with
    the forthcoming paper on geodesics.
  - Increase order of series using in GeographicLib::Geodesic to 6 (full
    accuracy maintained for ellipsoid flattening < 0.01).
  - Macro __NO_LONG_DOUBLE_MATH to disable use of long double.
  - Correct declaration of GeographicLib::Math::isfinite to return a bool.
  - Changes in the \ref utilities,
    - improve error reporting when parsing command line arguments;
    - accept latitudes and longitudes in decimal degrees or degrees,
      minutes, and seconds, with optional hemisphere designators;
    - <a href="GeoConvert.1.html">GeoConvert</a> -z accepts zone or
      zone+hemisphere;
    - <a href="GeoidEval.1.html">GeoidEval</a> accepts any of the input
      formats used by <a href="GeoConvert.1.html">GeoConvert</a>;
    - <a href="CartConvert.1.html">CartConvert</a> allows the ellipsoid
      to be specified with -e.

 - <a  href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.1.tar.gz/download">1.1 (released 2010-02-09)</a>
  - FIX BUG (introduced in 2009-03) in EllipticFunction::E(sn,cn,dn).
  - Increase accuracy of scale calculation in TransverseMercator and
    TransverseMercatorExact.
  - Code and documentation changes for consistency with
    <a  href="http://arxiv.org/abs/1002.1417">arXiv:1002.1417</a>

 - <a  href="http://sf.net/projects/geographiclib/files/distrib/geographiclib-1.0.tar.gz/download">
   1.0 (released 2010-01-07)</a>
  - Add autoconf configuration files.
  - BUG FIX: Improve initial guess for Newton's method in
    PolarStereographic::Reverse.  (Previously this failed to converge
    when the co-latitude exceeded about 130 deg.)
  - Constructors for TransverseMercator, TransverseMercatorExact,
    PolarStereographic, Geocentric, and Geodesic now check for obvious
    problems with their arguments and throw an exception if necessary.
  - Most classes now include inspector functions such as MajorRadius()
    so that you can determine how instances were constructed.
  - Add GeographicLib::LambertConformalConic class.
  - Add GeographicLib::PolarStereographic::SetScale to allow the
    latitude of true scale to be specified.
  - Add solution and project files for Visual Studio 2008.
  - Add GeographicLib::GeographicErr for exceptions.
  - GeographicLib::Geoid changes:
    - BUG FIX: fix typo in GeographicLib::Geoid::Cache which could cause
      a segmentation fault in some cases when the cached area spanned
      the prime meridian.
    - Include sufficient edge data to allow heights to be returned for
      cached area without disk reads;
    - Add inspector functions to query the extent of the cache.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-11.tgz/download">2009-11</a>
  - Allow specification of "closest UTM zone" in GeographicLib::UTMUPS
    and <a href="GeoConvert.1.html">GeoConvert</a> (via -t option).
  - Utilities now complain is there are too many tokens on input lines.
  - Include real-to-real versions of GeographicLib::DMS::Decode and
    GeographicLib::DMS::Encode.
  - More house-cleaning changes:
    - Ensure that functions which return results through reference
      arguments do not alter the arguments when an exception is thrown.
    - Improve accuracy of GeographicLib::MGRS::Forward.
    - Include more information in some error messages.
    - Improve accuracy of inverse hypobolic functions.
    - Fix the way GeographicLib::Math functions handle different precisions.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-10.tgz/download">2009-10</a>
  - Change web site to http://geographiclib.sourceforge.net
  - Several house-cleaning changes:
    - Change from the a flat directory structure to a more easily
      maintained one.
    - Introduce Math class for common mathematical functions (in
      Constants.hpp).
    - Use Math::real as the type for all real quantities.  By default this
      is typedefed to double; and the library should be installed this
      way.
    - Eliminate const reference members of AzimuthalEquidistant,
      CassiniSoldner and LocalCartesian so that they may be copied.
    - Make several constructors explicit.  Disallow some constructors.
      Disallow copy constructor/assignment for Geoid.
    - Document least square formulas in Geoid.cpp.
    - Use unsigned long long for files positions of geoid files in Geoid.
    - Introduce optional mgrslimits argument in UTMUPS::Forward and
      UTMUPS::Reverse to enforce stricter MGRS limits on eastings and
      northings.
    - Add 64-bit targets in Visual Studio project files.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-09.tgz/download">2009-09</a>
  - Add GeographicLib::Geoid and
    <a href="GeoidEval.1.html">GeoidEval</a> utility.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-08.tgz/download">2009-08</a>
  - Add GeographicLib::CassiniSoldner class and
    <a href="EquidistantTest.1.html">EquidistantTest</a> utility.
  - Fix bug in GeographicLib::Geodesic::Inverse where NaNs were
    sometimes returned.
  - INCOMPATIBLE CHANGE: AzimuthalEquidistant now returns the reciprocal
    of the azimuthal scale instead of the reduced length.
  - Add -n option to <a href="GeoConvert.1.html">GeoConvert</a>.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-07.tgz/download">2009-07</a>
  - Speed up the series inversion code in tmseries.mac and geod.mac.
  - Reference Borkowski in section on \ref geocentric.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-06.tgz/download">2009-06</a>
  - Add routines to decode and encode zone+hemisphere to GeographicLib::UTMUPS.
  - Clean up code in GeographicLib::Geodesic.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-05.tgz/download">2009-05</a>
  - Improvements to GeographicLib::Geodesic:
    - more economical series expansions,
    - return reduced length (as does the
      <a href="Geod.1.html">Geod</a> utility),
    - improved calculation of starting point for inverse method,
    - use reduced length to give derivative for Newton's method.
  - Add GeographicLib::AzimuthalEquidistant class.
  - Make GeographicLib::Geocentric, GeographicLib::TransverseMercator,
    and GeographicLib::PolarStereographic classes work with prolate
    ellipsoids.
  - <a href="CartConvert.1.html">CartConvert</a> checks its inputs more
    carefully.
  - Remove reference to defunct Constants.cpp from GeographicLib.vcproj.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-04.tgz/download">2009-04</a>
  - Use compile-time constants to select the order of series in
    GeographicLib::TransverseMercator.
  - 2x unroll of Clenshaw summation to avoid data shuffling.
  - Simplification of GeographicLib::EllipticFunction::E.
  - Use STATIC_ASSERT for compile-time checking of constants.
  - Improvements to GeographicLib::Geodesic:
    - compile-time option to change order of series used,
    - post Maxima code for generating the series,
    - tune the order of series for double,
    - improvements in the selection of starting points for Newton's
      method,
    - accept and return spherical arc lengths,
    - works with both oblate and prolate ellipsoids,
    - add -a, -e, -b options to the <a href="Geod.1.html">Geod</a> utility.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-03.tgz/download">2009-03</a>
  - Add GeographicLib::Geodesic and the <a href="Geod.1.html">Geod</a> utility.
  - Declare when no exceptions are thrown by functions.
  - Minor changes to GeographicLib::DMS class.
  - Use invf = 0 to mean a sphere in constructors to some classes.
  - The makefile creates a library and includes an install target.
  - Rename GeographicLib::ECEF to GeographicLib::Geocentric, ECEFConvert
    to <a href="CartConvert.1.html">CartConvert</a>.
  - Use inline functions to define constant doubles in Constants.hpp.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-02.tgz/download">2009-02</a>
  - Fix documentation of constructors (flattening -> inverse
    flattening).
  - Use std versions of math functions.
  - Add GeographicLib::ECEF and GeographicLib::LocalCartesian classes
    and the ECEFConvert utility.
  - Gather the documentation on the utility programs onto one page.

 - <a href="http://sf.net/projects/geographiclib/files/distrib/Geographic-2009-01.tgz/download">2009-01</a>
  - First proper release of library.
  - More robust GeographicLib::TransverseMercatorExact:
    - Introduce \e extendp version of constructor,
    - Test against extended test data,
    - Optimize starting positions for Newton's method,
    - Fix behavior near all singularities,
    - Fix order dependence in C++ start-up code,
    - Improved method of computing scale and convergence.
  - Documentation on transverse Mercator projection.
  - Add GeographicLib::MGRS, GeographicLib::UTMUPS, etc.

 - 2008-09
  - Ad hoc posting of information on the transverse Mercator projection.

<center>
Back to \ref utilities.  Up to \ref contents.
</center>
**********************************************************************/
